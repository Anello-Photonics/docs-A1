

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unit Configurations &mdash; Anello Developer Manual  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/my_theme.css?v=547657ed" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Vehicle Configuration" href="vehicle_configuration.html" />
    <link rel="prev" title="Python Tool Troubleshooting" href="setup_troubleshooting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Anello Developer Manual
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ANELLO Developer Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started_quick.html">EVK Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_gnssins.html">GNSS INS Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_imu.html">IMU &amp; IMU+ Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_x3.html">X3 Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_tool.html">ANELLO Python Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup_troubleshooting.html">Python Tool Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Unit Configurations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#unit-configuration-settings">Unit Configuration Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gnss-ins-and-anello-evk">GNSS / INS and ANELLO EVK:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#imu-imu-and-anello-x3">IMU / IMU+ and ANELLO X3:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-imu-anello-ahrs-commands">Additional IMU+ ANELLO AHRS Commands:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-data-rate-odr">Output Data Rate (ODR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#digital-filters">Digital Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unit-installation-orientation">Unit Installation Orientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#anello-unit-installation-misalignment">ANELLO Unit Installation Misalignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#azupt-for-anello-ahrs">AZUPT for ANELLO AHRS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vehicle_configuration.html">Vehicle Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="communication_messaging.html">Communication &amp; Messaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="mechanicals.html">Mechanicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="drive_testing.html">Drive Testing Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="fw_upgrade.html">Firmware Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="software_tools.html">Software Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_limitations.html">Known Issues and Limitations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Anello Developer Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Unit Configurations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/unit_configuration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="unit-configurations">
<h1>Unit Configurations<a class="headerlink" href="#unit-configurations" title="Link to this heading"></a></h1>
<p>The easiest way to configure an ANELLO unit is using the <a class="reference external" href="https://docs-a1.readthedocs.io/en/latest/python_tool.html#unit-configurations">ANELLO Python Program</a>,
which saves all changes to non-volatile flash memory.</p>
<p>Alternatively, the unit can be configured using the <a class="reference external" href="https://docs-a1.readthedocs.io/en/latest/communication_messaging.html#apcfg-messages">APCFG message</a>.</p>
<section id="unit-configuration-settings">
<h2>Unit Configuration Settings<a class="headerlink" href="#unit-configuration-settings" title="Link to this heading"></a></h2>
<p>The available parameters and values to configure are described in the table below:</p>
<section id="gnss-ins-and-anello-evk">
<h3>GNSS / INS and ANELLO EVK:<a class="headerlink" href="#gnss-ins-and-anello-evk" title="Link to this heading"></a></h3>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Configuration</p></td>
<td><p>APCFG Code</p></td>
<td><p>Value/Description</p></td>
</tr>
<tr class="row-even"><td><p>Orientation</p></td>
<td><p>orn</p></td>
<td><p>Coordinate axes for mounting position, default +X+Y+Z (see below)</p></td>
</tr>
<tr class="row-odd"><td><p>Alignment Angles</p></td>
<td><p>aln</p></td>
<td><p>Alignment angles of unit in degrees, in +X+Y+Z (roll, pitch, yaw) order. Default +0.0+0.0+0.0</p></td>
</tr>
<tr class="row-even"><td><p>Output Data Rate</p></td>
<td><p>odr</p></td>
<td><p>Output rate of APIMU message: 20, 50, 100, or 200 Hz. Requires reset.</p></td>
</tr>
<tr class="row-odd"><td><p>Enable GPS 1</p></td>
<td><p>gps1</p></td>
<td><p>Use primary antenna (ANT1): ‘on’, ‘off’</p></td>
</tr>
<tr class="row-even"><td><p>Enable GPS 2</p></td>
<td><p>gps2</p></td>
<td><p>Use secondary antenna (ANT2): ‘on’, ‘off’</p></td>
</tr>
<tr class="row-odd"><td><p>Odometer Units</p></td>
<td><p>odo</p></td>
<td><p>Speed unit of the odometer message: ‘mps’, ‘mph’, ‘kph’, ‘fps’</p></td>
</tr>
<tr class="row-even"><td><p>Enable FOG</p></td>
<td><p>fog</p></td>
<td><p>Enable optical gyro data to be used in algorithm: ‘on’, ‘off’</p></td>
</tr>
<tr class="row-odd"><td><p>DHCP (auto-assign IP)</p></td>
<td><p>dhcp</p></td>
<td><p>DHCP (let router assign EVK IP for UDP messaging): ‘on’, ‘off’</p></td>
</tr>
<tr class="row-even"><td><p>EVK UDP Port</p></td>
<td><p>lip</p></td>
<td><p>EVK’s IP address, applies only if DHCP off: aaa.bbb.ccc.ddd</p></td>
</tr>
<tr class="row-odd"><td><p>Computer UDP Port</p></td>
<td><p>rip</p></td>
<td><p>IP address of computer for UDP communication: aaa.bbb.ccc.eee</p></td>
</tr>
<tr class="row-even"><td><p>UDP Data Port</p></td>
<td><p>rport1</p></td>
<td><p>Computer’s UDP port for data output (works like data serial port): integer from 1 to 65535</p></td>
</tr>
<tr class="row-odd"><td><p>UDP Configuration Port</p></td>
<td><p>rport2</p></td>
<td><p>Computer’s UDP port for config messaging (works like data serial port): integer from 1 to 65535</p></td>
</tr>
<tr class="row-even"><td><p>UDP Odometer Port</p></td>
<td><p>rport3</p></td>
<td><p>Computer’s UDP port for odometer messaging: integer from 1 to 65535</p></td>
</tr>
<tr class="row-odd"><td><p>APCFG Output</p></td>
<td><p>min</p></td>
<td><p>Minutes between output of APCFG configuration values over the data port (0 disables output)</p></td>
</tr>
<tr class="row-even"><td><p>Accel Cutoff Freq</p></td>
<td><p>lpa</p></td>
<td><p>Low-pass filter cutoff frequency [Hz] for the MEMS accelerometer (0 disables filter)</p></td>
</tr>
<tr class="row-odd"><td><p>MEMS Gyro Cutoff Freq</p></td>
<td><p>lpw</p></td>
<td><p>Low-pass filter cutoff frequency [Hz] for the MEMS angular rate sensor (0 disables filter)</p></td>
</tr>
<tr class="row-even"><td><p>FOG Cutoff Freq</p></td>
<td><p>lpo</p></td>
<td><p>Low-pass filter cutoff frequency [Hz] for the optical gyro (0 disables filter)</p></td>
</tr>
<tr class="row-odd"><td><p>NTRIP Input Channel</p></td>
<td><p>ntrip</p></td>
<td><p>Input channel for NTRIP data. 0: off (default), 1: Serial, 2: UDP</p></td>
</tr>
<tr class="row-even"><td><p>Sync Pulse Enable</p></td>
<td><p>sync</p></td>
<td><p>Enables the external synchronization pulse input: ‘on’, ‘off’</p></td>
</tr>
<tr class="row-odd"><td><p>Output Message Format</p></td>
<td><p>mfm</p></td>
<td><p>Format of the output messages. 1: ASCII, 4: RTCM (default)</p></td>
</tr>
<tr class="row-even"><td><p>Enable Serial Output</p></td>
<td><p>uart</p></td>
<td><p>Enable output over serial interface: ‘on’, ‘off’</p></td>
</tr>
<tr class="row-odd"><td><p>Enable Ethernet Output</p></td>
<td><p>eth</p></td>
<td><p>Enable output over ethernet interface: ‘on’, ‘off’</p></td>
</tr>
<tr class="row-even"><td><p>NMEA Output Messages</p></td>
<td><p>nmea</p></td>
<td><p>Configures NMEA messages to be output on the config port. Bit 0 = GGA, Bit 1 = GSA, Bit 2 = RMC</p></td>
</tr>
<tr class="row-odd"><td><p>Baud Rate</p></td>
<td><p>bau</p></td>
<td><p>Serial communication baud rate in bits per second. Requires reset.</p></td>
</tr>
<tr class="row-even"><td><p>NHC</p></td>
<td><p>nhc</p></td>
<td><p>Non-holonomic constraint. 0: Default Vehicle, 2: Heavy Vibration Vehicle, 7: NHC off (not recommended)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The UDP ports are the numbers on the connected computer only. The EVK uses UDP port 1 for data, 2 for configuration, and 3 for odometer.</p>
</div>
</section>
<section id="imu-imu-and-anello-x3">
<h3>IMU / IMU+ and ANELLO X3:<a class="headerlink" href="#imu-imu-and-anello-x3" title="Link to this heading"></a></h3>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Configuration</p></td>
<td><p>APCFG Code</p></td>
<td><p>Value/Description</p></td>
</tr>
<tr class="row-even"><td><p>Output Data Rate</p></td>
<td><p>odr</p></td>
<td><p>Output rate of APIMU message: 20, 50, 100, or 200 Hz. Requires reset.</p></td>
</tr>
<tr class="row-odd"><td><p>Accel Cutoff Freq</p></td>
<td><p>lpa</p></td>
<td><p>Low-pass filter cutoff frequency [Hz] for the MEMS accelerometer (0 disables filter)</p></td>
</tr>
<tr class="row-even"><td><p>MEMS Gyro Cutoff Freq</p></td>
<td><p>lpw</p></td>
<td><p>Low-pass filter cutoff frequency [Hz] for the MEMS angular rate sensor (0 disables filter)</p></td>
</tr>
<tr class="row-odd"><td><p>FOG Cutoff Freq</p></td>
<td><p>lpo</p></td>
<td><p>Low-pass filter cutoff frequency [Hz] for the optical gyro (0 disables filter)</p></td>
</tr>
<tr class="row-even"><td><p>Baud Rate</p></td>
<td><p>bau</p></td>
<td><p>Serial communication baud rate in bits per second. Requires reset.</p></td>
</tr>
<tr class="row-odd"><td><p>Sync Pulse Enable</p></td>
<td><p>sync</p></td>
<td><p>Enables the external synchronization pulse input: ‘on’, ‘off’</p></td>
</tr>
<tr class="row-even"><td><p>Output Message Format</p></td>
<td><p>mfm</p></td>
<td><p>Format of the output messages. 1: ASCII, 4: RTCM (default)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="additional-imu-anello-ahrs-commands">
<h3>Additional IMU+ ANELLO AHRS Commands:<a class="headerlink" href="#additional-imu-anello-ahrs-commands" title="Link to this heading"></a></h3>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Configuration</p></td>
<td><p>APCFG Code</p></td>
<td><p>Value/Description</p></td>
</tr>
<tr class="row-even"><td><p>Enable AHRS</p></td>
<td><p>ahrs</p></td>
<td><p>Enables or disables the AHRS filter output and calculations. This command is flash only.</p></td>
</tr>
<tr class="row-odd"><td><p>Enable ZUPT</p></td>
<td><p>azupt</p></td>
<td><p>Configures the ZUPT mode for the AHRS filter. 0 is off, 1 is heading lock. This command is RAM only.</p></td>
</tr>
<tr class="row-even"><td><p>Heading Update</p></td>
<td><p>ahdg</p></td>
<td><p>Allows the user to load in a custom heading to the AHRS filter. Input format is degrees * 1000 to give 3
decimals of precision. Ex: 180.123 would be loaded as  180123. This command is RAM only.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some configurations require a system reset after changing, such as the ODR and baud rate. This can be done by selecting “Reset” in the user_program.py main menu, or sending the reset command over the Configuration port: #APRST,0*58</p>
</div>
</section>
<section id="output-data-rate-odr">
<h3>Output Data Rate (ODR)<a class="headerlink" href="#output-data-rate-odr" title="Link to this heading"></a></h3>
<p>The GNSS INS has output data rate constraints when outputting data over RS-232. In RTCM or binary messaging mode,
maximum ODR is 100 Hz. In ASCII mode, maximum ODR is 50 Hz.
All other ANELLO units support ODR up to 200 Hz. RTCM message format is recommended for best timing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Decreasing the baud rate will affect the maximum output data rate. It is recommended to keep the default baud rate (921600 for EVK; 230400 for GNSS INS and IMU) enable highest ODR.</p>
</div>
</section>
<section id="digital-filters">
<h3>Digital Filters<a class="headerlink" href="#digital-filters" title="Link to this heading"></a></h3>
<p>Fixed-point digital filters are implemented in the firmware and operate on the raw sensors readings (counts) prior to conversion to scaled
sensor readings (in [g] and [°/s]). Cutoff frequencies can be selected by the user using the APCFG command for the accelerometers (lpa),
MEMS angular-rate sensors (lpw), and optical gyroscopes (lpo).</p>
<p>Any integer value between zero and 90% of Nyquist frequency (0.5*ODR) can be selected. A zero value disables filtering and any value above 90% Nyquist is limited.</p>
</section>
<section id="unit-installation-orientation">
<h3>Unit Installation Orientation<a class="headerlink" href="#unit-installation-orientation" title="Link to this heading"></a></h3>
<p>Orientation describes the mounting orientation of the ANELLO Unit on the vehicle.
This configuration is only used in the ANELLO algorithm and does not affect IMU data output.</p>
<p>The following 8 right hand rule frames are possible:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>+X+Y+Z  Default; Unit mounted upright with X pointing in vehicle forward</p></li>
<li><p>+Y-X+Z  Unit mounted upright with X pointing in vehicle left</p></li>
<li><p>-Y+X+Z  Unit mounted upright with X pointing in vehicle right</p></li>
<li><p>-X-Y+Z  Unit mounted upright with X pointing in vehicle back</p></li>
<li><p>+X-Y-Z  Unit mounted upside down with X pointing in vehicle forward</p></li>
<li><p>+Y+X-Z  Unit mounted upside down with X pointing in vehicle right</p></li>
<li><p>-Y-X-Z  Unit mounted upside down with X pointing in vehicle left</p></li>
<li><p>-X+Y-Z  Unit mounted upside down with X pointing in vehicle back</p></li>
</ol>
</div></blockquote>
</section>
<section id="anello-unit-installation-misalignment">
<h3>ANELLO Unit Installation Misalignment<a class="headerlink" href="#anello-unit-installation-misalignment" title="Link to this heading"></a></h3>
<p>Misalignment in the unit installation will degrade performance, particularly in GNSS-denied periods.
ANELLO recommends the following procedure for calibrating roll and pitch installation misalignment angles.
Please ensure the Alignment Angles configuration is set to (0,0,0) before starting the procedure.</p>
<ol class="arabic simple">
<li><p>Park the vehicle in any location and take note of the roll and pitch reported by the ANELLO unit.</p></li>
<li><p>Park the vehicle in the same location but rotated 180 degrees, and take note of the roll and pitch reported by the ANELLO unit.</p></li>
<li><p>Ensure that there is no difference in side or front/rear load on the vehicle which may affect the roll or pitch between the two tests.</p></li>
<li><p>Calculate roll misalignment angle = (roll_1 + roll_2) / 2</p></li>
<li><p>Calculate pitch misalignment angle = (pitch_1 + pitch_2) / 2</p></li>
<li><p>Use the calculated roll and pitch misalignment angles, and any known heading misalignment angles, to set the Alignment Angles configuration using the ANELLO Python tool or the APCFG command with aln code.</p></li>
</ol>
<p>Example:
roll_1 = 5.0, pitch_1 = -10.0
roll_2 = 1.0, pitch_2 = 0.0</p>
<p>Roll misalignment angle = (roll_1 + roll_2) / 2 = 3.0
Pitch misalignment angle = (pitch_1 + pitch_2) / 2 = -5.0</p>
<p>Alignment Angle (roll, pitch, yaw) = +3.0, -5.0, 0.0</p>
<p>After setting the configuration and restarting the unit, the unit should now show roll and pitch equivalent to the slope of the ground when parked in the same spot.
For reference, the slope of the ground using the example above can be calculated by:</p>
<p>Roll slope = (roll_1 - roll_2) / 2 = 2.0
Pitch slope = (pitch_1 - pitch_2) / 2 = -5.0</p>
</section>
<section id="azupt-for-anello-ahrs">
<h3>AZUPT for ANELLO AHRS<a class="headerlink" href="#azupt-for-anello-ahrs" title="Link to this heading"></a></h3>
<p>Zero velocity update (ZUPT) is used to tell the IMU AHRS system that it is stationary. The user should only command this mode when the user can confirm that the system is stationary and turn off the mode before motion starts. While ZUPT is on, heading is locked, roll and pitch are estimated with accelerometer values, and angular rate biases are estimated. While ZUPT is off, the angular rates have the biases subtracted before being input into the filter</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="setup_troubleshooting.html" class="btn btn-neutral float-left" title="Python Tool Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vehicle_configuration.html" class="btn btn-neutral float-right" title="Vehicle Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Anello Photonics, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>