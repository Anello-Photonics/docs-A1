Communication & Messaging
===========================

1.  Interfacing
--------------------------

The communication interfaces currently supported for the ANELLO Maritime INS:

+-----------------+----------------------------------------------------+
| Interface       | Supported Protocols                                |
+=================+====================================================+
| RS232-1         | Mavlink (QGroundControl), NMEA 0183, ANELLO Binary |
+-----------------+----------------------------------------------------+
| RS232-2         | NMEA 0183, ANELLO Binary                           |
+-----------------+----------------------------------------------------+
| Ethernet        | NMEA 0183, ANELLO Binary                           |
+-----------------+----------------------------------------------------+
| CAN             | NMEA 2000                                          |
+-----------------+----------------------------------------------------+


2. Input Messages
---------------------------------

2.1  NMEA 0183 Data Input Messages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The ANELLO Maritime INS supports standard NMEA 0183 input messages which allow the USV to send in external sensor information (e.g., speed-aiding).  
ANELLO also has proprietary messages following the NMEA proprietary format, with a prefix of “$P”, company code “AP” (ANELLO Photonics), and the message code.

The minimum sensor aiding for the ANELLO Maritime INS is velocity aiding via either a paddle wheel, Doppler velocity log (DVL), or another source.

2.1.1. RPM: Revolutions
""""""""""""""""""""""""

**Message Format**::

    $--RPM,a,x,x.x,x.x,A*hh

+-------+------------+---------------------------------------------------------------+
| Index | Part       | Description                                                   |
+=======+============+===============================================================+
| 1     | a          | Source; S = Shaft, E = Engine                                 |
+-------+------------+---------------------------------------------------------------+
| 2     | x          | Engine or shaft number                                        |
+-------+------------+---------------------------------------------------------------+
| 3     | x.x        | Speed, revolutions per minute                                 |
+-------+------------+---------------------------------------------------------------+
| 4     | x.x        | Propeller pitch, % of maximum, "-" means astern               |
+-------+------------+---------------------------------------------------------------+
| 5     | A          | Status, A = data valid                                        |
+-------+------------+---------------------------------------------------------------+
| 6     | hh         | Checksum                                                      |
+-------+------------+---------------------------------------------------------------+


2.1.2. RSA: Rudder Sensor Angle
""""""""""""""""""""""""""""""""

**Message Format**::

    $--RSA,x.x,A,x.x,A*hh

+-------+------------+-------------------------------------------------------------+
| Index | Part       | Description                                                 |
+=======+============+=============================================================+
| 1     | x.x        | Starboard (or single) rudder sensor, "-" means port turn    |
+-------+------------+-------------------------------------------------------------+
| 2     | A          | Status, A = data valid                                      |
+-------+------------+-------------------------------------------------------------+
| 3     | x.x        | Port rudder sensor                                          |
+-------+------------+-------------------------------------------------------------+
| 4     | A          | Status, A = data valid                                      |
+-------+------------+-------------------------------------------------------------+
| 5     | hh         | Checksum                                                    |
+-------+------------+-------------------------------------------------------------+


2.1.3. VHW: Water Speed & Heading
"""""""""""""""""""""""""""""""""

**Message Format**::

    $--VHW,x.x,T,x.x,M,x.x,N,x.x,K*hh

+-------+------------+---------------------------------------------------------------+
| Index | Part       | Description                                                   |
+=======+============+===============================================================+
| 1     | x.x        | True heading, degrees                                         |
+-------+------------+---------------------------------------------------------------+
| 2     | T          | T = True                                                      |
+-------+------------+---------------------------------------------------------------+
| 3     | x.x        | Magnetic heading, degrees                                     |
+-------+------------+---------------------------------------------------------------+
| 4     | M          | M = Magnetic                                                  |
+-------+------------+---------------------------------------------------------------+
| 5     | x.x        | Speed, knots (relative to water)                              |
+-------+------------+---------------------------------------------------------------+
| 6     | N          | N = Knots                                                     |
+-------+------------+---------------------------------------------------------------+
| 7     | x.x        | Speed, km/h (relative to water)                               |
+-------+------------+---------------------------------------------------------------+
| 8     | K          | K = Kilometres per hour                                       |
+-------+------------+---------------------------------------------------------------+
| 9     | hh         | Checksum                                                      |
+-------+------------+---------------------------------------------------------------+


2.1.4. VBW: Dual Ground/Water Speed
""""""""""""""""""""""""""""""""""""

**Message Format**::

    $--VBW,x.x,x.x,A,x.x,x.x,A*hh

+-------+------------+---------------------------------------------------------------+
| Index | Part       | Description                                                   |
+=======+============+===============================================================+
| 1     | x.x        | Longitudinal water speed, "-" means astern                    |
+-------+------------+---------------------------------------------------------------+
| 2     | x.x        | Transverse water speed, "-" means port                        |
+-------+------------+---------------------------------------------------------------+
| 3     | A          | Status, A = data valid                                        |
+-------+------------+---------------------------------------------------------------+
| 4     | x.x        | Longitudinal ground speed, "-" means astern                   |
+-------+------------+---------------------------------------------------------------+
| 5     | x.x        | Transverse ground speed, "-" means port                       |
+-------+------------+---------------------------------------------------------------+
| 6     | A          | Status, A = data valid                                        |
+-------+------------+---------------------------------------------------------------+
| 7     | hh         | Checksum                                                      |
+-------+------------+---------------------------------------------------------------+
